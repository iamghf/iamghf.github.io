<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="HTTP Request Smuggling, 网络,树莓派,编程,Java,大数据,Flink,ChatGPT,spring,微服务,springcloud">
    <meta name="description" content="我折腾 我快乐">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>HTTP Request Smuggling | ghf</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>
    <script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?c1b480119ac4758bb84d4885b5046e83";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>

    <!-- Clarity tracking code for https://iamghf.top/ -->
    <script>
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i+"?ref=bwt";
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "j9amie3njm");
    </script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="ghf" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">ghf</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="https://iamghf.top/" class="waves-effect waves-light">
      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Wiki</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">ghf</div>
        <div class="logo-desc">
            
            我折腾 我快乐
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="https://iamghf.top/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-list"></i>
			
			Wiki
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">HTTP Request Smuggling</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
        
        position: absolute;
        right: 23.5vw;
        display: block;
    }

    .toc-fixed .toc-link::before{
        position: fixed!important;/*当toc的位置改为fixed时，.toc-link::before也要改为fixed*/
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">
                                <span class="chip bg-color">网络安全</span>
                            </a>
                        
                            <a href="/tags/%E6%BC%8F%E6%B4%9E/">
                                <span class="chip bg-color">漏洞</span>
                            </a>
                        
                            <a href="/tags/smuggling/">
                                <span class="chip bg-color">smuggling</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/" class="post-category">
                                网络技术
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-04-08
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    18 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="HTTP-Request-Smuggling"><a href="#HTTP-Request-Smuggling" class="headerlink" title="HTTP Request Smuggling"></a>HTTP Request Smuggling</h1><h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><p>攻击者通过构造特殊结构的请求，干扰网站服务器对请求的处理，从而实现攻击目标</p>
<h2 id="前提知识"><a href="#前提知识" class="headerlink" title="前提知识"></a>前提知识</h2><blockquote>
<p>注：以下文章中的前端指的是(代理服务器、CDN、WAF,负载均衡,Nginx,HAproxy等)</p>
</blockquote>
<p><code>Persistent Connection:</code>持久连接，<strong>Connection: keep-alive</strong>。<br>比如打开一个网页，我们可以在浏览器控制端看到浏览器发送了许多请求(HTML、图片、css、js)，而我们知道每一次发送HTTP请求需要经过 TCP 三次握手，发送完毕又有四次挥手。当单个用户同时需要发送多个请求时，这一点消耗或许微不足道，但当有许多用户同时发起请求的时候，便会给服务器造成很多不必要的消耗。为了解决这一问题，在 HTTP 协议中便新加了 Connection: keep-alive 这一个请求头，当有些请求带着 Connection: close 的话，通信完成之后，服务器才会中断 TCP 连接。如此便解决了额外消耗的问题，但是服务器端处理请求的方式仍旧是请求一次响应一次，然后再处理下一个请求，当一个请求发生阻塞时，便会影响后续所有请求，为此 Pipelining 异步技术解决了这一个问题</p>
<p><code>Pipelining:</code>能一次处理多个请求，客户端不必等到上一个请求的响应后再发送下一个请求。服务器那边一次可以接收多个请求，需要遵循先入先出机制，将请求和响应严格对应起来，再将响应发送给客户端<br><img src="https://img.iamghf.top/md/202404080951446.png" alt="pipelining"></p>
<p>但是这样也会带来一个问题————如何区分每一个请求才不会导致混淆————前端与后端必须短时间内对每个数据包的边界大小达成一致。否则，攻击者就可以构造发送一个特殊的数据包发起攻击。那么如何界定数据包边界呢？<br>有两种方式： <strong>Content-Length</strong> 、 <strong>Transfer-Encoding</strong>.</p>
<p><code>Content-Length:</code><strong>CL</strong>，请求体或者响应体长度(十进制)。字符算一个，CRLF(一个换行)算两个。通常如果 Content-Length 的值比实际长度小，会造成内容被截断；如果比实体内容大，会造成 pending，也就是等待直到超时。</p>
<p><code>Transfer-Encoding:</code><strong>TE</strong>，其只有一个值 <strong>chunked</strong> (分块编码)。分块编码相当简单，在头部加入 Transfer-Encoding: chunked 之后，就代表这个报文采用了分块编码。这时，报文中的实体需要改为用一系列分块来传输。每个分块包含十六进制的长度值和数据，长度值独占一行，长度不包括它结尾的 CRLF（\r\n），也不包括分块数据结尾的 CRLF，但是包括分块中的换行，值算2。最后一个分块长度值必须为 0，对应的分块数据没有内容，表示实体结束。<br>例如：</p>
<pre class=" language-http"><code class="language-http">POST /langdetect HTTP/1.1
<span class="token header-name keyword">Host:</span> fanyi.baidu.com
<span class="token header-name keyword">User-Agent:</span> Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
<span class="token header-name keyword">Content-Type:</span> application/x-www-form-urlencoded
<span class="token header-name keyword">Content-Length:</span> 93
<span class="token header-name keyword">Transfer-Encoding:</span> chunked

2;逗号后面是注释
qu
3;3表示后面的字符长度为3(十六进制)，不算CRLF(\r\n回车换行)
ery
1
=
2
ja
2
ck
0;0表示实体结束</code></pre>
<p>注：根据 RFC 标准，如果接收到的消息同时具有传输编码标头字段和内容长度标头字段，则必须忽略内容长度标头字段，当然也有不遵循标准的例外。</p>
<p>根据标准，当接受到如 Transfer-Encoding: chunked, error 有多个值或者不识别的值时的时候，应该返回 400 错误。但是有一些方法可以绕过<br>(导致既不返回400错误，又可以使 Transfer-Encoding 标头失效)：</p>
<pre class=" language-http"><code class="language-http"><span class="token header-name keyword">Transfer-Encoding:</span> xchunked
Transfer-Encoding : chunked
<span class="token header-name keyword">Transfer-Encoding:</span> chunked
<span class="token header-name keyword">Transfer-Encoding:</span> x
<span class="token header-name keyword">Transfer-Encoding:</span>[tab]chunked
GET / HTTP/1.1
 Transfer-Encoding: chunked
<span class="token header-name keyword">X:</span> X[\n]Transfer-Encoding: chunked
Transfer-Encoding
 : chunked</code></pre>
<h2 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h2><p>HTTP规范提供了两种不同方式来指定请求的结束位置，它们是 Content-Length 标头和 Transfer-Encoding 标头。当前/后端对数据包边界的校验不一致时，<br>使得后端将一个恶意的残缺请求需要和下一个正常的请求进行拼接，从而吞并了其他用户的正常请求。如图：</p>
<p><img src="https://img.iamghf.top/md/202404080953272.png" alt="原因">]</p>
<p>那么前/后端校验不一致有那些情况呢呢呢呢？😵</p>
<h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><ol>
<li><code>CL-TE:</code> 前端: Content-Length,后端: Transfer-Encoding</li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te" target="_blank" rel="noopener">BURP实验环境</a></p>
<p>第一次请求：<br><img src="https://img.iamghf.top/md/202404080958234.png" alt="第一次请求"></p>
<p>第二次请求：<br><img src="https://img.iamghf.top/md/202404080959655.png" alt="第二次请求"></p>
<p>原理：前端服务器通过 Content-Length 界定数据包边界，检测到数据包无异常通过，然后传输到后端服务器，后端服务器通过 Transfer-Encoding 界定数据包边界，导致 <em>R0oKi3</em> 字段被识别为下一个数据包的内容，而被送到了缓冲区，由于内容不完整，会等待后续数据，当正常用户的请求传输到后端时，与之前滞留的恶意数据进行了拼接，组成了 <em>R0OKI3POST</em> ，为不可识别的请求方式，导致403。</p>
<ol>
<li><code>TE-CL:</code> 前端: Transfer-Encoding,后端: Content-Length</li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/lab-basic-te-cl" target="_blank" rel="noopener">BURP实验环境</a><br><em>记得关 burp 的 Update Content-Length 功能</em></p>
<p>第一次请求：<br><img src="https://img.iamghf.top/md/202404081000851.png" alt="img"></p>
<p>第二次请求：<br><img src="https://img.iamghf.top/md/202404081000459.png" alt="img"></p>
<p>原理：跟 CL-TE 相似</p>
<ol>
<li><code>TE-TE:</code> 前端: Transfer-Encoding,后端: Transfer-Encoding</li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/lab-ofuscating-te-header" target="_blank" rel="noopener">BURP实验环境</a><br><em>记得关 burp 的 Update Content-Length 功能</em></p>
<p>第一次请求：<br><img src="https://img.iamghf.top/md/202404081001738.png" alt="img"></p>
<p>第二次请求：<br><img src="https://img.iamghf.top/md/202404081001653.png" alt="img"></p>
<p>原理：前端服务器通过第一个 Transfer-Encoding 界定数据包边界，检测到数据包无异常通过，然后传输到后端服务器，后端服务器通过第二个 Transfer-Encoding 界定数据包边界，结果为一个不可识别的标头，然后便退而求其次使用 Content-Length 校验，结果就跟 TE-CL 形式无异了。同样若是前端服务器校验第二个，后端服务器校验第一个，那结果也就跟 CL-TE 形式无异了。</p>
<ol>
<li><code>CL-CL:</code> 前端: Content-Length,后端: Content-Length</li>
</ol>
<p>在RFC7230规范中，规定当服务器收到的请求中包含两个 Content-Length，而且两者的值不同时，需要返回400错误。但难免会有服务器不严格遵守该规范。假设前端和后端服务器都收到该类请求，且不报错，其中前端服务器按照第一个Content-Length的值对请求进行为数据包定界，而后端服务器则按照第二个Content-Length的值进行处理。</p>
<p>这时攻击者可以恶意构造一个特殊的请求：</p>
<pre class=" language-http"><code class="language-http">POST / HTTP/1.1
<span class="token header-name keyword">Host:</span> example.com
<span class="token header-name keyword">Content-Length:</span> 11
<span class="token header-name keyword">Content-Length:</span> 5

123
R0oKi3</code></pre>
<p>原理：前端服务器获取到的数据包的长度11，由此界定数据包边界，检测到数据包无异常通过，然后传输到后端，而后端服务器获取到的数据包长度为5。当读取完前5个字符后，后端服务器认为该请求已经读取完毕。便去识别下一个数据包，而此时的缓冲区中还剩下 <em>R0oKi3</em>，它被认为是下一个请求的一部分，由于内容不完整，会等待后续数据，当正常用户的请求传输到后端时，与之前滞留的恶意数据进行了拼接，攻击便在此展开。</p>
<ol>
<li><code>CL 不为 0 的 GET 请求:</code></li>
</ol>
<p>假设前端服务器允许 GET 请求携带请求体，而后端服务器不允许 GET 请求携带请求体，它会直接忽略掉 GET 请求中的 Content-Length 头，不进行处理。这就有可能导致请求走私。<br>比如发送下面请求：</p>
<pre class=" language-makefile"><code class="language-makefile">GET / HTTP/1.1
<span class="token symbol">Host</span><span class="token punctuation">:</span> example.com
<span class="token symbol">Content-Length</span><span class="token punctuation">:</span> 72

POST /comment HTTP/1.1
<span class="token symbol">Host</span><span class="token punctuation">:</span> example.com
<span class="token symbol">Content-Length</span><span class="token punctuation">:</span>666

msg<span class="token operator">=</span>aaa</code></pre>
<p>前端服务器通过读取Content-Length，确认这是个完整的请求，然后转发到后端服务器，而后端服务器因为不对 Content-Length 进行判断，于是在后端服务器中该请求就变成了两个：<br>第一个：</p>
<pre class=" language-http"><code class="language-http">GET / HTTP/1.1
<span class="token header-name keyword">Host:</span> example.com
<span class="token header-name keyword">Content-Length:</span> 72</code></pre>
<p>第二个：</p>
<pre class=" language-http"><code class="language-http">POST /comment HTTP/1.1
<span class="token header-name keyword">Host:</span> example.com
<span class="token header-name keyword">Content-Length:</span>666

msg=aaa</code></pre>
<p>而第二个为 POST 请求，假定其为发表评论的数据包，再假定后端服务器是依靠 Content-Length 来界定数据包的，那么由于数据包长度为 666，那么便会等待其他数据，等到正常用户的请求包到来，便会与其拼接，变成 msg=aaa……………… ，然后会将显示在评论页面，也就会导致用户的 Cookie 等信息的泄露。</p>
<h2 id="PortSwigger-其他实验"><a href="#PortSwigger-其他实验" class="headerlink" title="PortSwigger 其他实验"></a>PortSwigger 其他实验</h2><ol>
<li><strong>使用 CL-TE 绕过前端服务器安全控制</strong></li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te" target="_blank" rel="noopener">BURP实验环境</a><br>坑点：有时候实体数据里需要添加一些别的字段或者空行，不然会出一些很奇怪的错误，所以我在弄的时候参照了<a href="https://paper.seebug.org/1048/#51" target="_blank" rel="noopener">seebug 404Team</a><br>实验要求：获取 admin 身份并删除 carlos 用户</p>
<p>第一步：实验提示我们 admin 管理面版在 /admin 目录下，直接访问，显示：<br><img src="https://img.iamghf.top/md/202404081002537.png" alt="img"></p>
<p>第二步：利用 CL-TE 请求走私绕过前端服务器安全控制</p>
<ul>
<li>第一次发包<br><img src="https://img.iamghf.top/md/202404081003080.png" alt="img"></li>
</ul>
<p>坑点：数据实体一定要多一些其他字段或者多两行空白，不然报 Invalid request 请求不合法</p>
<pre class=" language-http"><code class="language-http">0

GET /admin HTTP/1.1


# 若是多了两行空白，那么 foo: bar 字段可以不要</code></pre>
<p>提示 admin 要从 localhost 登陆</p>
<ul>
<li>改包后多发几次得到<br><img src="https://img.iamghf.top/md/202404081003789.png" alt="img"></li>
<li>改包删除用户<br><img src="https://img.iamghf.top/md/202404081003220.png" alt="img"></li>
<li>再次请求 /admin 页面，发现 carlos 用户已不存在<br><img src="https://img.iamghf.top/md/202404081004166.png" alt="img"><br>坑点：这里再次请求的时候记得多加两个空行改变一下 Content-Length 的值，不然会显示不出来，神奇 BUG？</li>
</ul>
<p>原理：网站进行身份验证的处理是在前端服务器，当直接访问 /admin 目录时，由于通过不了前端验证，所以会返回 Blocked。利用请求走私，便可以绕过前端验证，直接在后端产生一个访问 /admin 目录的请求包，当发起下一个请求时，响应的数据包对应的是走私的请求包，如此便可以查看 admin 面板的页面数据，从而达到绕过前端身份验证删除用户的目的。</p>
<ol>
<li><strong>使用 TE-CL 绕过前端服务器安全控制</strong></li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl" target="_blank" rel="noopener">BURP实验环境</a></p>
<p>实验过程与上一个实验相仿，不过要记得关 burp 的 <em>Update Content-Length</em><br><img src="https://img.iamghf.top/md/202404081004174.png" alt="img"></p>
<p>这里：不知道为什么一定要加 Content-Length 和其他的一些词，不加的话会显示 Invalid request 请求不合法 ？？？？？？？？？</p>
<ol>
<li><strong>获取前端服务器重写请求字段(CL-TE)</strong></li>
</ol>
<p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-reveal-front-end-request-rewriting" target="_blank" rel="noopener">BURP实验环境</a></p>
<blockquote>
<p>摘自<a href="https://paper.seebug.org/1048/#52" target="_blank" rel="noopener">seebug 404Team</a><br>在有的网络环境下，前端代理服务器在收到请求后，不会直接转发给后端服务器，而是先添加一些必要的字段，然后再转发给后端服务器。这些字段是后端服务器对请求进行处理所必须的，比如：</p>
<ul>
<li>描述TLS连接所使用的协议和密码</li>
<li>包含用户IP地址的XFF头</li>
<li>用户的会话令牌ID<br>总之，如果不能获取到代理服务器添加或者重写的字段，我们走私过去的请求就不能被后端服务器进行正确的处理。那么我们该如何获取这些值呢。PortSwigger提供了一个很简单的方法，主要是三大步骤：</li>
<li>找一个能够将请求参数的值输出到响应中的POST请求</li>
<li>把该POST请求中，找到的这个特殊的参数放在消息的最后面</li>
<li>然后走私这一个请求，然后直接发送一个普通的请求，前端服务器对这个请求重写的一些字段就会显示出来。</li>
</ul>
</blockquote>
<ul>
<li>第一步：找一个能够将请求参数的值输出到响应中的POST请求<br><img src="https://img.iamghf.top/md/202404081005750.png" alt="img"></li>
<li>第二步：利用 CL-TE 走私截获正常数据包经前端服务器修改后发送过来的内容，并输出在响应包中<br><img src="https://img.iamghf.top/md/202404081005882.png" alt="img"></li>
</ul>
<p>这一步的原理：由于我们走私构造的请求包为：</p>
<pre class=" language-makefile"><code class="language-makefile">POST / HTTP/1.1
<span class="token symbol">Content-Length</span><span class="token punctuation">:</span> 100

search<span class="token operator">=</span>66666</code></pre>
<p>从这里可以看到，Content-Length 的值为 100，而我们的实体数据仅为 search=66666，远没有 100，于是后端服务器便会进入等待状态，当下一个正常请求到来时，会与之前滞留的请求进行拼接，从而导致走私的请求包吞并了下一个请求的部分或全部内容，并返回走私请求的响应。</p>
<ul>
<li>第三步：在走私的请求上添加这个字段，然后走私一个删除用户的请求。<br><img src="https://img.iamghf.top/md/202404081005723.png" alt="img"></li>
<li>查看 /admin 页面，发现用户已被删除<br><img src="https://img.iamghf.top/md/202404081006646.png" alt="img"></li>
</ul>
<h2 id="能用来干什么"><a href="#能用来干什么" class="headerlink" title="能用来干什么"></a>能用来干什么</h2><ol>
<li>账户劫持 CL-TE<br><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-capture-other-users-requests" target="_blank" rel="noopener">BURP实验环境</a></li>
</ol>
<ul>
<li>构造特殊请求包，形成一个走私请求<br><img src="https://img.iamghf.top/md/202404081006837.png" alt="img"></li>
<li>查看评论<br><img src="https://img.iamghf.top/md/202404081006473.png" alt="img"></li>
</ul>
<p>原理：(跟 <em>获取前端服务器重写请求字段</em> 相似)<br>我们走私构造的请求包为：</p>
<pre class=" language-makefile"><code class="language-makefile">POST /post/comment HTTP/1.1
<span class="token symbol">Host</span><span class="token punctuation">:</span> aca41ff41e89d28f800d3e82001a00c8.web-security-academy.net
<span class="token symbol">Content-Length</span><span class="token punctuation">:</span> 900
<span class="token symbol">Cookie</span><span class="token punctuation">:</span> session<span class="token operator">=</span>XPbI3LJQJCoBcQOvsLdfyCNbOKqsGudy

csrf<span class="token operator">=</span>Nk6OsCxcNIUdfnrpQuy9N3WO0zLLcAWU&amp;postId<span class="token operator">=</span>4&amp;name<span class="token operator">=</span>aaa&amp;email<span class="token operator">=</span>aaa%40aaa.com&amp;website<span class="token operator">=</span>&amp;comment<span class="token operator">=</span>aaaa</code></pre>
<p>可以看到 Content-Length 值为 900，而我们的实体数据仅为 csrf=Nk6OsCxcNIUdfnrpQuy9N3WO0zLLcAWU&amp;postId=4&amp;name=aaa&amp;email=aaa%40aaa.com&amp;website=&amp;comment=aaaa，远不足900，于是后端服务器便会进入等待状态，当下一个正常请求到来时，会与之前滞留的请求进行拼接，从而导致走私的请求包吞并了下一个请求的部分或全部内容，并且由于是构造发起评论的请求包，所以数据会存入数据库，从而打开页面便会看到其他用户的请求包内容，获取其敏感数据，由于环境只有我一个人在玩，所以只能获取到自己的敏感数据。</p>
<p>注意：一定要将 comment=aaaa 放在最后</p>
<ol>
<li>Reflected XSS + Smuggling 造成无需交互的 XSS（CL-TE）<br><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss" target="_blank" rel="noopener">BURP实验环境</a></li>
</ol>
<ul>
<li>首先反射型 XSS 在文章页面<br><img src="https://img.iamghf.top/md/202404081007032.png" alt="img"></li>
<li>构造请求走私 payload<br><img src="https://img.iamghf.top/md/202404081007198.png" alt="img"></li>
<li>导致无交互 XSS<br><img src="https://img.iamghf.top/md/202404081007654.png" alt="img"></li>
</ul>
<ol>
<li>恶意重定向<br><a href="http://codesharer.cn.com/" target="_blank" rel="noopener">环境暂无</a></li>
</ol>
<blockquote>
<p>许多应用程序执行从一个 URL 到另一个URL的重定向，会将来自请求的 Host 标头的主机名放入重定向URL。一个示例是 Apache 和 IIS Web 服务器的默认行为，在该行为中，对不带斜杠的文件夹的请求将收到对包含该斜杠的文件夹的重定向：</p>
</blockquote>
<pre class=" language-http"><code class="language-http">请求
GET /home HTTP/1.1
<span class="token header-name keyword">Host:</span> normal-website.com

响应
<span class="token response-status">HTTP/1.1 <span class="token property">301 Moved Permanently</span></span>
<span class="token header-name keyword">Location:</span> https://normal-website.com/home/</code></pre>
<blockquote>
<p>通常，此行为被认为是无害的，但是可以在走私请求攻击中利用它来将其他用户重定向到外部域。例如：</p>
</blockquote>
<pre class=" language-http"><code class="language-http"> POST / HTTP/1.1
<span class="token header-name keyword">Host:</span> vulnerable-website.com
<span class="token header-name keyword">Content-Length:</span> 54
<span class="token header-name keyword">Transfer-Encoding:</span> chunked

0

GET /home HTTP/1.1
<span class="token header-name keyword">Host:</span> attacker-website.com
<span class="token header-name keyword">Foo:</span> X </code></pre>
<blockquote>
<p>走私的请求将触发重定向到攻击者的网站，这将影响后端服务器处理的下一个用户的请求。例如：</p>
</blockquote>
<pre class=" language-makefile"><code class="language-makefile">正常请求
GET /home HTTP/1.1
<span class="token symbol">Host</span><span class="token punctuation">:</span> attacker-website.com
<span class="token symbol">Foo</span><span class="token punctuation">:</span> XGET /scripts/<span class="token keyword">include</span>.js HTTP/1.1
<span class="token symbol">Host</span><span class="token punctuation">:</span> vulnerable-website.com

恶意响应
HTTP/1.1 301 Moved Permanently
<span class="token symbol">Location</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//attacker-website.com/home/ </code></pre>
<blockquote>
<p>若用户请求的是一个 JavaScript 文件，该文件是由网站上的页面导入的。攻击者可以通过在响应中返回自己的 JavaScript 文件来完全破坏受害者用户。</p>
</blockquote>
<p>4.缓存投毒</p>
<blockquote>
<p>一般来说，前端服务器出于性能原因，会对后端服务器的一些资源进行缓存，如果存在HTTP请求走私漏洞，则有可能使用重定向来进行缓存投毒，从而影响后续访问的所有用户。</p>
</blockquote>
<p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-perform-web-cache-poisoning" target="_blank" rel="noopener">BURP实验环境</a></p>
<p><a href="https://paper.seebug.org/1048/#55" target="_blank" rel="noopener">实验参考</a></p>
<h2 id="检测"><a href="#检测" class="headerlink" title="检测"></a>检测</h2><blockquote>
<p>检测请求走私漏洞的明显方法是发出一个模糊的请求，然后发出正常的“受害者”请求，然后观察后者是否得到意外的响应。但是，这极易受到干扰。</p>
</blockquote>
<blockquote>
<p>如果另一个用户的请求在我们的受害者请求之前命中，他们将得到损坏的响应，我们将不会发现该漏洞。这意味着在具有大量流量的实时站点上，很难证明请求走私存在而不会在此过程中影响众多真正的用户。即使在没有其他流量的站点上，您也可能会因应用程序级别的怪癖终止连接而导致漏报。</p>
</blockquote>
<blockquote>
<p>为了解决这个问题，作者开发了一种检测策略，该策略使用一系列消息，这些消息使易受攻击的后端系统挂起并使连接超时。这种技术几乎没有误报，抵制应用程序级别的怪癖，最重要的是几乎没有影响其他用户的风险。</p>
</blockquote>
<blockquote>
<p>假设前端服务器使用Content-Length头，后端使用Transfer-Encoding头。我将此定位称为CL.TE。我们可以通过发送以下请求来检测潜在的请求走私：</p>
</blockquote>
<pre class=" language-http"><code class="language-http">POST / HTTP/1.1
<span class="token header-name keyword">Host:</span> example.com
<span class="token header-name keyword">Content-Length:</span> 4
<span class="token header-name keyword">Transfer-Encoding:</span> chunked

1
R
x</code></pre>
<blockquote>
<p>由于较短的Content-Length，前端将仅转发到 R 丢弃后续的 X，而后端将在等待下一个块大小时超时。这将导致明显的时间延迟。<br>如果超时说明两个服务器为CL.TE，正常响应就是CL.CL，被拒绝就可能是TE.TE或者TE.CL,那么只需要在拒绝的时候，再使用第二个请求，TE.TE就会正常响应，TE.CL就会超时。</p>
</blockquote>
<blockquote>
<p>如果两个服务器同步（TE.TE或CL.CL），请求将被前端拒绝或由两个系统无害地处理。最后，如果以相反的方式发生（TE.CL），前端将拒绝该消息，而不会将其转发到后端，这要归功于无效的块大小“Q”。这可以防止后端中毒。</p>
</blockquote>
<blockquote>
<p>我们可以使用以下请求安全地检测TE.CL：</p>
</blockquote>
<pre class=" language-http"><code class="language-http">POST / HTTP/1.1
<span class="token header-name keyword">Host:</span> example.com
<span class="token header-name keyword">Content-Length:</span> 6
<span class="token header-name keyword">Transfer-Encoding:</span> chunked

0


X</code></pre>
<blockquote>
<p>如果以相反的方式发生（CL.TE），则此方法将使用X毒化后端套接字，可能会损害合法用户。幸运的是，通过首先运行先前的检测方法，我们可以排除这种可能性。</p>
</blockquote>
<blockquote>
<p>这些请求可以适应目标解析中的任意差异，并且它们用于通过HTTP Request Smuggler自动识别请求走私漏洞。HTTP Request Smuggler是为帮助此类攻击而开发的开源Burp Suite扩展。它们现在也被用在Burp Suite的核心扫描仪中。虽然这是服务器级漏洞，但单个域上的不同接口通常会路由到不同的目标，因此应将此技术单独应用于每个接口。</p>
</blockquote>
<h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><blockquote>
<ol>
<li>禁用后端连接的重用，以便每个后端请求通过单独的网络连接发送。</li>
<li>使用HTTP / 2进行后端连接，因为此协议可防止对请求之间的边界产生歧义。</li>
<li>前端服务器和后端服务器使用完全相同的Web服务器软件，以便它们就请求之间的界限达成一致。<br>以上的措施有的不能从根本上解决问题，而且有着很多不足，就比如禁用代理服务器和后端服务器之间的 TCP 连接重用，会增大后端服务器的压力。使用 HTTP/2 在现在的网络条件下根本无法推广使用，哪怕支持 HTTP/2 协议的服务器也会兼容 HTTP/1.1。从本质上来说，HTTP 请求走私出现的原因并不是协议设计的问题，而是不同服务器实现的问题，个人认为最好的解决方案就是严格的实现 RFC7230-7235 中所规定的的标准，但这也是最难做到的。</li>
</ol>
</blockquote>
<p>HTTP 参数污染也能算是一种请求走私 <a href="https://www.cnblogs.com/wjrblogs/p/12966636.html" target="_blank" rel="noopener">HTTP参数污染</a></p>
<p><a href="https://www.cnblogs.com/wjrblogs/p/13152813.html" target="_blank" rel="noopener">原文地址</a></p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://iamghf.top" rel="external nofollow noreferrer">ghf</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://iamghf.top/web-lou-dong-1.html">https://iamghf.top/web-lou-dong-1.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://iamghf.top" target="_blank">ghf</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">
                                    <span class="chip bg-color">网络安全</span>
                                </a>
                            
                                <a href="/tags/%E6%BC%8F%E6%B4%9E/">
                                    <span class="chip bg-color">漏洞</span>
                                </a>
                            
                                <a href="/tags/smuggling/">
                                    <span class="chip bg-color">smuggling</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">one for all, all for one</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '7140a41ed2ddd46c10c7',
        clientSecret: '9f81b92236315959b71eb3c245a4f02f922a7651',
        repo: 'xjbsay',
        owner: 'iamghf',
        admin: "iamghf",
        id: '2024-04-08T09-48-05',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/llm.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="大模型LLM在Text2SQL上的应用实践">
                        
                        <span class="card-title">大模型LLM在Text2SQL上的应用实践</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            大模型LLM在Text2SQL上的应用实践前言目前，大模型的一个热门应用方向Text2SQL，它可以帮助用户快速生成想要查询的SQL语句，再结合可视化技术可以降低使用数据的门槛，更便捷的支持决策。本文将从以下四个方面介绍LLM在Text2S
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-04-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/AI/" class="post-category">
                                    AI
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/">
                        <span class="chip bg-color">大模型</span>
                    </a>
                    
                    <a href="/tags/llm/">
                        <span class="chip bg-color">llm</span>
                    </a>
                    
                    <a href="/tags/text2sql/">
                        <span class="chip bg-color">text2sql</span>
                    </a>
                    
                    <a href="/tags/langchain/">
                        <span class="chip bg-color">langchain</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/cookie-session-token-jwt-de-qu-bie.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="Cookie、Session、Token、JWT的区别">
                        
                        <span class="card-title">Cookie、Session、Token、JWT的区别</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Cookie、Session、Token、JWT的区别什么是认证（Authentication）
通俗地讲就是验证当前用户的身份，证明 “你是你自己”（比如：你每天上下班打卡，都需要通过指纹打卡，当你的指纹和系统里录入的指纹相匹配时，就打卡
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-04-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" class="post-category">
                                    编程语言
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/cookie/">
                        <span class="chip bg-color">cookie</span>
                    </a>
                    
                    <a href="/tags/session/">
                        <span class="chip bg-color">session</span>
                    </a>
                    
                    <a href="/tags/token/">
                        <span class="chip bg-color">token</span>
                    </a>
                    
                    <a href="/tags/jwt/">
                        <span class="chip bg-color">jwt</span>
                    </a>
                    
                    <a href="/tags/%E8%AE%A4%E8%AF%81/">
                        <span class="chip bg-color">认证</span>
                    </a>
                    
                    <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">
                        <span class="chip bg-color">网络安全</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->


<!-- 代码块收缩 -->


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="https://iamghf.top" target="_blank">ghf</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://www.beian.miit.gov.cn/" target="_blank">湘ICP备18008192号-1</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/iamghf" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:841567545@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=841567545" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 841567545" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?c1b480119ac4758bb84d4885b5046e83";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
